// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package mongodbatlas

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-mongodbatlas/sdk/v4/go/mongodbatlas/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// `LogIntegration` provides a resource for managing log integration configurations at the project level. This resource allows you to continually export `mongod`, `mongos`, and audit logs to an AWS S3 bucket with 1-minute log export intervals.
//
// To use this resource, the requesting Service Account or API Key must have the Organization Owner or Project Owner role.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-mongodbatlas/sdk/v4/go/mongodbatlas"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			project, err := mongodbatlas.NewProject(ctx, "project", &mongodbatlas.ProjectArgs{
//				Name:  pulumi.Any(atlasProjectName),
//				OrgId: pulumi.Any(atlasOrgId),
//			})
//			if err != nil {
//				return err
//			}
//			// Set up cloud provider access in Atlas using the created IAM role
//			setupOnly, err := mongodbatlas.NewCloudProviderAccessSetup(ctx, "setup_only", &mongodbatlas.CloudProviderAccessSetupArgs{
//				ProjectId:    project.ID(),
//				ProviderName: pulumi.String("AWS"),
//			})
//			if err != nil {
//				return err
//			}
//			authRole, err := mongodbatlas.NewCloudProviderAccessAuthorization(ctx, "auth_role", &mongodbatlas.CloudProviderAccessAuthorizationArgs{
//				ProjectId: project.ID(),
//				RoleId:    setupOnly.RoleId,
//				Aws: &mongodbatlas.CloudProviderAccessAuthorizationAwsArgs{
//					IamAssumedRoleArn: pulumi.Any(atlasRole.Arn),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			// Set up log integration with authorized IAM role
//			exampleLogIntegration, err := mongodbatlas.NewLogIntegration(ctx, "example", &mongodbatlas.LogIntegrationArgs{
//				ProjectId:  project.ID(),
//				BucketName: pulumi.Any(logBucket.Bucket),
//				IamRoleId:  authRole.RoleId,
//				PrefixPath: pulumi.String("atlas-logs"),
//				Type:       pulumi.String("S3_LOG_EXPORT"),
//				LogTypes: pulumi.StringArray{
//					pulumi.String("MONGOD_AUDIT"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			example := mongodbatlas.LookupLogIntegrationOutput(ctx, mongodbatlas.GetLogIntegrationOutputArgs{
//				ProjectId:     exampleLogIntegration.ProjectId,
//				IntegrationId: exampleLogIntegration.IntegrationId,
//			}, nil)
//			exampleGetLogIntegrations := mongodbatlas.LookupLogIntegrationsOutput(ctx, mongodbatlas.GetLogIntegrationsOutputArgs{
//				ProjectId: exampleLogIntegration.ProjectId,
//			}, nil)
//			ctx.Export("logIntegrationBucketName", example.ApplyT(func(example mongodbatlas.GetLogIntegrationResult) (*string, error) {
//				return &example.BucketName, nil
//			}).(pulumi.StringPtrOutput))
//			ctx.Export("logIntegrationsResults", exampleGetLogIntegrations.ApplyT(func(exampleGetLogIntegrations mongodbatlas.GetLogIntegrationsResult) ([]mongodbatlas.GetLogIntegrationsResult, error) {
//				return []mongodbatlas.GetLogIntegrationsResult(exampleGetLogIntegrations.Results), nil
//			}).([]mongodbatlas.GetLogIntegrationsResultOutput))
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// Log integration resource can be imported using the project ID and log integration ID, separated by a slash, e.g.
//
// For more information see: [MongoDB Atlas API - Log Integration](https://www.mongodb.com/docs/api/doc/atlas-admin-api-v2/group/endpoint-push-based-log-export) Documentation.
type LogIntegration struct {
	pulumi.CustomResourceState

	// Human-readable label that identifies the S3 bucket name for storing log files.
	BucketName pulumi.StringOutput `pulumi:"bucketName"`
	// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
	IamRoleId pulumi.StringOutput `pulumi:"iamRoleId"`
	// Unique 24-character hexadecimal digit string that identifies the log integration configuration.
	IntegrationId pulumi.StringOutput `pulumi:"integrationId"`
	// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
	KmsKey pulumi.StringPtrOutput `pulumi:"kmsKey"`
	// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
	LogTypes pulumi.StringArrayOutput `pulumi:"logTypes"`
	// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
	PrefixPath pulumi.StringOutput `pulumi:"prefixPath"`
	// Unique 24-hexadecimal digit string that identifies your project.
	ProjectId pulumi.StringOutput `pulumi:"projectId"`
	// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
	Type pulumi.StringOutput `pulumi:"type"`
}

// NewLogIntegration registers a new resource with the given unique name, arguments, and options.
func NewLogIntegration(ctx *pulumi.Context,
	name string, args *LogIntegrationArgs, opts ...pulumi.ResourceOption) (*LogIntegration, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.BucketName == nil {
		return nil, errors.New("invalid value for required argument 'BucketName'")
	}
	if args.IamRoleId == nil {
		return nil, errors.New("invalid value for required argument 'IamRoleId'")
	}
	if args.LogTypes == nil {
		return nil, errors.New("invalid value for required argument 'LogTypes'")
	}
	if args.PrefixPath == nil {
		return nil, errors.New("invalid value for required argument 'PrefixPath'")
	}
	if args.ProjectId == nil {
		return nil, errors.New("invalid value for required argument 'ProjectId'")
	}
	if args.Type == nil {
		return nil, errors.New("invalid value for required argument 'Type'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource LogIntegration
	err := ctx.RegisterResource("mongodbatlas:index/logIntegration:LogIntegration", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetLogIntegration gets an existing LogIntegration resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetLogIntegration(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *LogIntegrationState, opts ...pulumi.ResourceOption) (*LogIntegration, error) {
	var resource LogIntegration
	err := ctx.ReadResource("mongodbatlas:index/logIntegration:LogIntegration", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering LogIntegration resources.
type logIntegrationState struct {
	// Human-readable label that identifies the S3 bucket name for storing log files.
	BucketName *string `pulumi:"bucketName"`
	// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
	IamRoleId *string `pulumi:"iamRoleId"`
	// Unique 24-character hexadecimal digit string that identifies the log integration configuration.
	IntegrationId *string `pulumi:"integrationId"`
	// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
	KmsKey *string `pulumi:"kmsKey"`
	// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
	LogTypes []string `pulumi:"logTypes"`
	// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
	PrefixPath *string `pulumi:"prefixPath"`
	// Unique 24-hexadecimal digit string that identifies your project.
	ProjectId *string `pulumi:"projectId"`
	// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
	Type *string `pulumi:"type"`
}

type LogIntegrationState struct {
	// Human-readable label that identifies the S3 bucket name for storing log files.
	BucketName pulumi.StringPtrInput
	// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
	IamRoleId pulumi.StringPtrInput
	// Unique 24-character hexadecimal digit string that identifies the log integration configuration.
	IntegrationId pulumi.StringPtrInput
	// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
	KmsKey pulumi.StringPtrInput
	// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
	LogTypes pulumi.StringArrayInput
	// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
	PrefixPath pulumi.StringPtrInput
	// Unique 24-hexadecimal digit string that identifies your project.
	ProjectId pulumi.StringPtrInput
	// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
	Type pulumi.StringPtrInput
}

func (LogIntegrationState) ElementType() reflect.Type {
	return reflect.TypeOf((*logIntegrationState)(nil)).Elem()
}

type logIntegrationArgs struct {
	// Human-readable label that identifies the S3 bucket name for storing log files.
	BucketName string `pulumi:"bucketName"`
	// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
	IamRoleId string `pulumi:"iamRoleId"`
	// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
	KmsKey *string `pulumi:"kmsKey"`
	// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
	LogTypes []string `pulumi:"logTypes"`
	// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
	PrefixPath string `pulumi:"prefixPath"`
	// Unique 24-hexadecimal digit string that identifies your project.
	ProjectId string `pulumi:"projectId"`
	// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
	Type string `pulumi:"type"`
}

// The set of arguments for constructing a LogIntegration resource.
type LogIntegrationArgs struct {
	// Human-readable label that identifies the S3 bucket name for storing log files.
	BucketName pulumi.StringInput
	// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
	IamRoleId pulumi.StringInput
	// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
	KmsKey pulumi.StringPtrInput
	// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
	LogTypes pulumi.StringArrayInput
	// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
	PrefixPath pulumi.StringInput
	// Unique 24-hexadecimal digit string that identifies your project.
	ProjectId pulumi.StringInput
	// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
	Type pulumi.StringInput
}

func (LogIntegrationArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*logIntegrationArgs)(nil)).Elem()
}

type LogIntegrationInput interface {
	pulumi.Input

	ToLogIntegrationOutput() LogIntegrationOutput
	ToLogIntegrationOutputWithContext(ctx context.Context) LogIntegrationOutput
}

func (*LogIntegration) ElementType() reflect.Type {
	return reflect.TypeOf((**LogIntegration)(nil)).Elem()
}

func (i *LogIntegration) ToLogIntegrationOutput() LogIntegrationOutput {
	return i.ToLogIntegrationOutputWithContext(context.Background())
}

func (i *LogIntegration) ToLogIntegrationOutputWithContext(ctx context.Context) LogIntegrationOutput {
	return pulumi.ToOutputWithContext(ctx, i).(LogIntegrationOutput)
}

// LogIntegrationArrayInput is an input type that accepts LogIntegrationArray and LogIntegrationArrayOutput values.
// You can construct a concrete instance of `LogIntegrationArrayInput` via:
//
//	LogIntegrationArray{ LogIntegrationArgs{...} }
type LogIntegrationArrayInput interface {
	pulumi.Input

	ToLogIntegrationArrayOutput() LogIntegrationArrayOutput
	ToLogIntegrationArrayOutputWithContext(context.Context) LogIntegrationArrayOutput
}

type LogIntegrationArray []LogIntegrationInput

func (LogIntegrationArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*LogIntegration)(nil)).Elem()
}

func (i LogIntegrationArray) ToLogIntegrationArrayOutput() LogIntegrationArrayOutput {
	return i.ToLogIntegrationArrayOutputWithContext(context.Background())
}

func (i LogIntegrationArray) ToLogIntegrationArrayOutputWithContext(ctx context.Context) LogIntegrationArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(LogIntegrationArrayOutput)
}

// LogIntegrationMapInput is an input type that accepts LogIntegrationMap and LogIntegrationMapOutput values.
// You can construct a concrete instance of `LogIntegrationMapInput` via:
//
//	LogIntegrationMap{ "key": LogIntegrationArgs{...} }
type LogIntegrationMapInput interface {
	pulumi.Input

	ToLogIntegrationMapOutput() LogIntegrationMapOutput
	ToLogIntegrationMapOutputWithContext(context.Context) LogIntegrationMapOutput
}

type LogIntegrationMap map[string]LogIntegrationInput

func (LogIntegrationMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*LogIntegration)(nil)).Elem()
}

func (i LogIntegrationMap) ToLogIntegrationMapOutput() LogIntegrationMapOutput {
	return i.ToLogIntegrationMapOutputWithContext(context.Background())
}

func (i LogIntegrationMap) ToLogIntegrationMapOutputWithContext(ctx context.Context) LogIntegrationMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(LogIntegrationMapOutput)
}

type LogIntegrationOutput struct{ *pulumi.OutputState }

func (LogIntegrationOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**LogIntegration)(nil)).Elem()
}

func (o LogIntegrationOutput) ToLogIntegrationOutput() LogIntegrationOutput {
	return o
}

func (o LogIntegrationOutput) ToLogIntegrationOutputWithContext(ctx context.Context) LogIntegrationOutput {
	return o
}

// Human-readable label that identifies the S3 bucket name for storing log files.
func (o LogIntegrationOutput) BucketName() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.BucketName }).(pulumi.StringOutput)
}

// Unique 24-hexadecimal digit string that identifies the AWS IAM role that MongoDB Cloud uses to access your S3 bucket.
func (o LogIntegrationOutput) IamRoleId() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.IamRoleId }).(pulumi.StringOutput)
}

// Unique 24-character hexadecimal digit string that identifies the log integration configuration.
func (o LogIntegrationOutput) IntegrationId() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.IntegrationId }).(pulumi.StringOutput)
}

// AWS KMS key ID or ARN for server-side encryption (optional). If not provided, uses bucket default encryption settings.
func (o LogIntegrationOutput) KmsKey() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringPtrOutput { return v.KmsKey }).(pulumi.StringPtrOutput)
}

// Array of log types to export to S3. Valid values: MONGOD, MONGOS, MONGOD*AUDIT, MONGOS*AUDIT.
func (o LogIntegrationOutput) LogTypes() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringArrayOutput { return v.LogTypes }).(pulumi.StringArrayOutput)
}

// S3 directory path prefix where the log files will be stored. MongoDB Cloud will add further sub-directories based on the log type.
func (o LogIntegrationOutput) PrefixPath() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.PrefixPath }).(pulumi.StringOutput)
}

// Unique 24-hexadecimal digit string that identifies your project.
func (o LogIntegrationOutput) ProjectId() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.ProjectId }).(pulumi.StringOutput)
}

// Human-readable label that identifies the service to which you want to integrate with MongoDB Cloud. The value must match the log integration type.
func (o LogIntegrationOutput) Type() pulumi.StringOutput {
	return o.ApplyT(func(v *LogIntegration) pulumi.StringOutput { return v.Type }).(pulumi.StringOutput)
}

type LogIntegrationArrayOutput struct{ *pulumi.OutputState }

func (LogIntegrationArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*LogIntegration)(nil)).Elem()
}

func (o LogIntegrationArrayOutput) ToLogIntegrationArrayOutput() LogIntegrationArrayOutput {
	return o
}

func (o LogIntegrationArrayOutput) ToLogIntegrationArrayOutputWithContext(ctx context.Context) LogIntegrationArrayOutput {
	return o
}

func (o LogIntegrationArrayOutput) Index(i pulumi.IntInput) LogIntegrationOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *LogIntegration {
		return vs[0].([]*LogIntegration)[vs[1].(int)]
	}).(LogIntegrationOutput)
}

type LogIntegrationMapOutput struct{ *pulumi.OutputState }

func (LogIntegrationMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*LogIntegration)(nil)).Elem()
}

func (o LogIntegrationMapOutput) ToLogIntegrationMapOutput() LogIntegrationMapOutput {
	return o
}

func (o LogIntegrationMapOutput) ToLogIntegrationMapOutputWithContext(ctx context.Context) LogIntegrationMapOutput {
	return o
}

func (o LogIntegrationMapOutput) MapIndex(k pulumi.StringInput) LogIntegrationOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *LogIntegration {
		return vs[0].(map[string]*LogIntegration)[vs[1].(string)]
	}).(LogIntegrationOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*LogIntegrationInput)(nil)).Elem(), &LogIntegration{})
	pulumi.RegisterInputType(reflect.TypeOf((*LogIntegrationArrayInput)(nil)).Elem(), LogIntegrationArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*LogIntegrationMapInput)(nil)).Elem(), LogIntegrationMap{})
	pulumi.RegisterOutputType(LogIntegrationOutput{})
	pulumi.RegisterOutputType(LogIntegrationArrayOutput{})
	pulumi.RegisterOutputType(LogIntegrationMapOutput{})
}
